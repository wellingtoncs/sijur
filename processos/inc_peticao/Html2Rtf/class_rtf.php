<?php 
// RTF Generator Class
//
// Example of use:
// 	$rtf = new rtf("rtf_config.php");
// 	$rtf->setPaperSize(5);
// 	$rtf->setPaperOrientation(1);
// 	$rtf->setDefaultFontFace(0);
// 	$rtf->setDefaultFontSize(24);
// 	$rtf->setAuthor("noginn");
// 	$rtf->setOperator("me@noginn.com");
// 	$rtf->setTitle("RTF Document");
// 	$rtf->addColour("#000000");
// 	$rtf->addText($_POST['text']);
// 	$rtf->getDocument();
//

require_once("source_rtf.php");

class rtf {

	// {\colortbl;\red 0\green 0\blue 0;\red 255\green 0\ blue0;\red0 ...}
	var $colour_table = array();
	var $colour_rgb;
	// {\fonttbl{\f0}{\f1}{f...}}
	var $font_table = array();
	var $font_face;
	var $font_size;
	// {\info {\title <title>} {\author <author>} {\operator <operator>}}
	var $info_table = array();
	var $page_width;
	var $page_height;
	var $page_size;
	var $page_orientation;
	var $rtf_version;
	var $tab_width;
	
	var $document;
	var $buffer;
	
	function rtf($config="rtf_config.php") {
		require_once($config);
		
		$this->setDefaultFontFace($font_face);
		$this->setDefaultFontSize($font_size);
		$this->setPaperSize($paper_size);
		$this->setPaperOrientation($paper_orientation);
		$this->rtf_version = $rtf_version;
		$this->tab_width = $tab_width;
	}
	
	function setDefaultFontFace($face) {
		$this->font_face = $face; // $font is interger
	}
	
	function setDefaultFontSize($size) {
		$this->font_size = $size;
	}
	
	function setTitle($title="") {
		$this->info_table["title"] = $title;
	}
	
	function setAuthor($author="") {
		$this->info_table["author"] = $author;
	}
	
	function setOperator($operator="") {
		$this->info_table["operator"] = $operator;
	}
	
	function setPaperSize($size=0) {
		global $inch, $cm, $mm;
		
		// 1 => Letter (8.5 x 11 inch)
		// 2 => Legal (8.5 x 14 inch)
		// 3 => Executive (7.25 x 10.5 inch)
		// 4 => A3 (297 x 420 mm)
		// 5 => A4 (210 x 297 mm)
		// 6 => A5 (148 x 210 mm)
		// Orientation considered as Portrait
		
		switch($size) {
			case 1:
				$this->page_width = floor(8.5*$inch);
				$this->page_height = floor(11*$inch);
				$this->page_size = 1;
				break;	
			case 2:
				$this->page_width = floor(8.5*$inch);
				$this->page_height = floor(14*$inch);
				$this->page_size = 5;
				break;	
			case 3:
				$this->page_width = floor(7.25*$inch);
				$this->page_height = floor(10.5*$inch);
				$this->page_size = 7;
				break;	
			case 4:
				$this->page_width = floor(297*$mm);
				$this->page_height = floor(420*$mm);
				$this->page_size = 8;
				break;	
			case 5:
			default:
				$this->page_width = floor(210*$mm);
				$this->page_height = floor(297*$mm);
				$this->page_size = 9;
				break;	
			case 6:
				$this->page_width = floor(148*$mm);
				$this->page_height = floor(210*$mm);
				$this->page_size = 10;
				break;	
		}
	}
	
	function setPaperOrientation($orientation=0) {
		// 1 => Portrait
		// 2 => Landscape
		
		switch($orientation) {
			case 1:
			default:
				$this->page_orientation = 1;
				break;
			case 2:
				$this->page_orientation = 2;
				break;	
		}
	}
	
	function addColour($hexcode) {
		// Get the RGB values
		$this->hex2rgb($hexcode);
		
		// Register in the colour table array
		$this->colour_table[] = array(
			"red"	=>	$this->colour_rgb["red"],
			"green"	=>	$this->colour_rgb["green"],
			"blue"	=>	$this->colour_rgb["blue"]
		);
	}
	
	// Convert HEX to RGB (#FFFFFF => r255 g255 b255)
	function hex2rgb($hexcode) {
		$hexcode = str_replace("#", "", $hexcode); 
		$rgb = array();
		$rgb["red"] = hexdec(substr($hexcode, 0, 2));
		$rgb["green"] = hexdec(substr($hexcode, 2, 2));
		$rgb["blue"] = hexdec(substr($hexcode, 4, 2));
		
		$this->colour_rgb = $rgb;
	}
	
	// Convert newlines into \par
	function nl2par($text) {
		$text = str_replace("\n", "\\par ", $text);
		
		return $text;
	}
	
	// Add a text string to the document buffer
	function addText($text) {
		$text = str_replace("\n", "", $text);
		$text = str_replace("\t", "", $text);
		$text = str_replace("\r", "", $text);
		
		$this->document .= $text;
	}
	
	// Ouput the RTF file
	function getDocument() {
		$this->buffer .= "{";
		// Header
		$this->buffer .= $this->getHeader();
		// Footer
		$this->buffer .= $this->getFooter();
		// Font table
		$this->buffer .= $this->getFontTable();
		// Colour table
		$this->buffer .= $this->getColourTable();
		// File Information
		$this->buffer .= $this->getInformation();
		// Default font values
		$this->buffer .= $this->getDefaultFont();
		// Page display settings
		$this->buffer .= $this->getPageSettings();
		// Parse the text into RTF
		$this->buffer .= $this->parseDocument();
		$this->buffer .= "}";		
		
		include 'conectar.php';

		$dir_cont = $_POST['url_dir'];
		$nomecli = ereg_replace("[^a-zA-Z0-9_]", "", strtr($_POST['nomecli'], "áàãâéêíóôõúüçÁÀÃÂÉÊÍÓÔÕÚÜÇ ", "aaaaeeiooouucAAAAEEIOOOUUC_"));
		//$query_doc = mysql_query("INSERT INTO documentos_tb SET st=1, pasta='', dossie='', subpasta='Corpo Principal', tpdoc='CONTESTAÇÃO', url='" . $dir_cont . '/DEFESA_' . $nomecli . '_' . date('YmdHis') . '.rtf' . "', arquivo='" . 'DEFESA_' . $nomecli . '_' . date('YmdHis') . '.rtf' . "', data_hora_st1='" . date('Y-m-d H:i:s') . "', data_hora_st2='" . date('Y-m-d H:i:s') . "', data_hora_st3='" . date('Y-m-d H:i:s') . "' ");

		if(!file_exists($dir_cont))
		{
			mkdir("$dir_cont", 0755);
		}
		
		$fopen = fopen("$dir_cont/DEFESA_" . $nomecli . "_" . date('YmdHis') . ".rtf", "w");
		fwrite($fopen,$this->buffer);
		fclose($fopen);
			
		header("Content-Type: text/enriched\n");
		header("Content-Disposition: attachment; filename=DEFESA-$nomecli.rtf");
		echo $this->buffer;
	}
	
	// Header
	function getHeader() {
		$header_buffer  = "\\rtf{$this->rtf_version}\\ansi\\deff0\\deftab{$this->tab_width} \paperw11906\paperh16838\margl1701\margr1134\margt1701\margb1134\gutter0\ltrsect \n\n";
		$header_buffer .= "{\\headerr\\qr \\fs14 {\\pict\\picscalex100\\picscaley100\\piccropl0\\piccropr0\\piccropt0\\piccropb0\\picw5133\\pich1535\\picwgoal2910\\pichgoal870\\jpegblip\\bliptag1199934383
ffd8ffe000104a46494600010101006000600000ffe1322b687474703a2f2f6e732e61646f62652e636f6d2f7861702f312e302f003c3f787061636b65742062
6567696e3d22efbbbf222069643d2257354d304d7043656869487a7265537a4e54637a6b633964223f3e0a3c783a786d706d65746120786d6c6e733a783d2261
646f62653a6e733a6d6574612f2220783a786d70746b3d2241646f626520584d5020436f726520352e302d633036302036312e3133343737372c20323031302f
30322f31322d31373a33323a30302020202020202020223e0a2020203c7264663a52444620786d6c6e733a7264663d22687474703a2f2f7777772e77332e6f72
672f313939392f30322f32322d7264662d73796e7461782d6e7323223e0a2020202020203c7264663a4465736372697074696f6e207264663a61626f75743d22
220a202020202020202020202020786d6c6e733a786d703d22687474703a2f2f6e732e61646f62652e636f6d2f7861702f312e302f223e0a2020202020202020
203c786d703a43726561746f72546f6f6c3e41646f62652046697265776f726b73204353352031312e302e302e3438342057696e646f77733c2f786d703a4372
6561746f72546f6f6c3e0a2020202020202020203c786d703a437265617465446174653e323031312d31312d32365431353a34333a34385a3c2f786d703a4372
65617465446174653e0a2020202020202020203c786d703a4d6f64696679446174653e323031312d31312d32365431353a34343a34375a3c2f786d703a4d6f64
696679446174653e0a2020202020203c2f7264663a4465736372697074696f6e3e0a2020202020203c7264663a4465736372697074696f6e207264663a61626f
75743d22220a202020202020202020202020786d6c6e733a64633d22687474703a2f2f7075726c2e6f72672f64632f656c656d656e74732f312e312f223e0a20
20202020202020203c64633a666f726d61743e696d6167652f6a7065673c2f64633a666f726d61743e0a2020202020203c2f7264663a4465736372697074696f
6e3e0a2020203c2f7264663a5244463e0a3c2f783a786d706d6574613e0a20202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
0a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
0a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020200a2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a20202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020200a20202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
2020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020
20202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020
202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020200a3c3f787061636b657420656e643d2277223f
3effdb004300040303030303040303040504030405070504040507080606070606080a0808080808080a080a0a0b0a0a080d0d0e0e0d0d121212121214141414
141414141414ffdb0043010505050807080f0a0a0f120f0c0f121615151515161614141414141414141414141414141414141414141414141414141414141414
1414141414141414141414ffc0001108003a00c203011100021101031101ffc4001d000002020203010000000000000000000000060507030801020409ffc400
3d1000010303030301060404040505000000010203040506110007121321312208141541516123324271163362812452829117254353637292a1a3b2ffc4001a
010100020301000000000000000000000000030401020506ffc4003211000202010400040502060203000000000001020311041221310513324114225161a171
b11523425281f033c191d1e1ffda000c03010002110311003f00dfed006803401a0303d322c771a69e750879e3c596c9f5ac8f3c53e4e340511bd9ed4b6bed54
b72dca4c6fe21bc5b1f8f0d0e74e344e4329f7974051e7f3e9a467eb8edae8693c3e772dcf8894753af855c76ca5e81eddf73a2a29fe29b569cfd214afc4f85b
aeb32509faa7aea750b23e9e9cfd46af4fc1e38f965cfdca50f1679f99706df587b836aee4d01ab8ed19e99b01c3c1d47e47d877e6d3ed9ee858fa1fdc6477d7
16ea6554b6c8ebd56c6c5988d1a8c903401a00d006803401a00d006803401a00d006803401a00d006803401a00d014c6e06f8314c79ca1d98944faaf2e9393f1
d461b5f8e2d01fcd5e7fd3fbe86322f3b77c1b3a833c0ae0a8eec555ae94aab2d067a29e57fa138294111c1cf4d0a014b1df03c6f0c2799746b2ce38eca8e936
0fb22969f1785df5491723ca53b3a755a598cfb8fb8792dc096029192a39f5151d75a3aad5cbd11e3f4398f4da65ea7c8897cfb3f5b92197ab3b1d7840bd6134
0adeb7932185d61b40ee4b29471f78007cb8057d396aed3ae9757476fdfd8a7768a2ff00e2967edee577b59ba5746cfdd48aed10a8b45419acd1dd250d4b6507
d4db80fe5713df82b1949fb641b5a9d346f861ff008656d3ea2544fec7d37dbcdc4b63736da8f73daf283d11df4c88eac07e33e3f332fa3f4ad3fec7c8c8d794
ba99532db23d3556c6c5988d9a889457a35fd6e576efb86c880ff3aedb288aba937db8e2620ad3c0e7bf0c617f4246a595328c14df52238daa5271f7433e7511
20138d011b47b82915f44b768f2912d98531ea7c971bfca24c63c5d403f3e0aec71f3d665171ecd6324fa24b58360ceb0046bcf7429b655d3695ab3297549b2a
ee96a891654267a91e3a91c4727d59181ebcf6ce1393e06a7ae9df172cae08a76ed697d479cea02513f72b70e16d8db4fddb57a74e9f45885026ae07454e35d5
712d20f075c6b902a581e9d4f452ee96d5d90df77951dcd7022c8f699b469748b7ee5b8a877051ed3b9b8fc2ebcfb31de89ebee3adeef21e71aec09c291e01fa
6a7f819b6e29a6e3edfea22f8c8a49b4d265ced3cd3ed21f616971975216db89394a92a19041f9823548b677ce803401a039d006803406ba6eeeed395275fb56
d77ca29a825aa8d41a3ddf578534d287fd31e1447e6fdbc8d595bdbb69cbabc5975b9321aa3da94a429eaa57a57a63b0db632ae3e0ad7fd29d6f18b6f0bb30da
4b2ca0371b7322d71f5d22cb66453ed96494fbe4851f884ec76ea3bc7096507c8691fea24ebd1e8fc3a35add3e65fb1c0d67884a7c4388959eba872ce524a169
75078ba83942d3d9408f983e46b0cca6d19a54b9539f5ca9afb926539fcc79d515b8a3f5528e493fbe89241b6f93633d90b6eaf7afde22eea7542a143b2a9cb0
2a72a338a6535275b394c203c38907bb871e91dbc9d727c52fad436e332fd8eaf865336f775137b6f2b958b3ed8a9dc6fa0bc20472b663a41529e7d5e8619484
824a9c714940c0f9ebcf570df248eece5b564d2d7eb11765f7eedbbea3d4a44ea25d71d316f29afb32a3a0ce92a026b83de1b6b280e943e803c0046bb8979fa7
947de3d7e9ec721bf26f52f67dff00d96ffb485c57650afbdaa896adc550a2b571d5fe1f514c558532b6faf182545958521440795fbfcf54b4508cabb1c96708
b5ac9c94e0a2f1917ad2ae5dc2fddefdb59d74d6e7d128d485cca54b932794f8ce06c2cf4a404828cf53184803b76c6a4b210f2eb9e165be4d21396fb2397c22
bab1aefaded87b29bd7f5bb519e9b82a9547e8f19b71deb4188b7df2b5cb6e32814f5b8b67d473dcf7d59baa576ab6be92c90d5375e9f72ce725acdddd72583b
c3b6d668acd52ad6fdf36eb7f198d5192b96e26a0a4aff00c5b0eac95b4a2a1ea4a08463c01aa8ea8d954e58c38b2c2b250b22bb52455512efdc9a8ed6eebdca
edf971a26d995f663d152dc909f41921921e5f1ea389e07f2f2033dce756dd55ab2b8ed5f32e4afe64f64e5b9f0cb0ae5dc1bd5772fb3c4f8f5c9d1537a350cd
c9098738c594731791535f9472eb2b3c71a8214c36dcb1e9ce3f24d3ba7baae7d5dfe08b46e25e77d5bfbd77f26bd54a3c8b2a4f42d28509f2cc68a888b7092f
303d1214f0400bea8579206359f2615bae38ceeecc79b29a9cb3e9e86adcfbc66dff00ec72fddf516d2d546a94f82b96940c23acdd41a69c5247c92a520a80fb
ea3d3d6abd66d5ecdfec6da89b9e9773ef8fdca8af785749f67edb0a9dd9eed3f68e17ba2a5d328e5512ae56e21c4325c7e4759a23ba93e84a7b9fee2dd4e3f1
1351f5bebe856b33e4c1cbd0589765ed5f99badb414ddb0b867d1ed0bbe86d2db82a3ce3b6c043884afdddce49ea34d0f19c15a4673df35abaa3e558e6b328b2
ccec7e64141e22d0d372d2afddb862cea2d5f70dfaddbd32bb2fe34b92e3cc5c5514c9e221c0a788a1c79c28249210a4f73dca5beda8612859b9edc3c71f45f7
64b2528616ecacff0097f620b646e3bb2f4a0ee1506e6bb2ab4ea55a3732549a9c87c7c4d8a54771d71e8aecb0547f231c54ac9c7ab07c6a4d5c230941c52f99
75ed922d2d8e71926f84cf57b3ed66f4dcdbeee0dc0f8e5658da6a6c85c0b6e8f324b8f096f71e25d74bbc94ae09f5919ecb501fa4eb1ac8c2a828616f7db37d
2ca5649cb2f6fb1b43ae617c340539be1b84ba2c2169d1dde3559edf29cf20fa988aaedc47d14ef8fb0fdc686325276259ef5e55c45342fdde98c27af5399e03
3193e7b9ec14af09ff007f96b26106f954bfe234e85b4964d520dbfb6541e0aaad69deaae34a989ee965a4b095adf4b1e547c170f73e9d74b4b657a75be5ccdf
4be850d542773d91e23eec8183ec6946b8a985db4772e154aaa94e54cae1706f3f7097d4ea07dca756578d73cc782b7f08e3d4511b91b417eed4cd4c6bbe9a5a
86f28a6255a39eb417c8f921e00615fd0b015f6d7534faaaeef4be4e6ea349653d89d04413363a6a8b7dba6975225b9192971f4b44fa94da145295280ee01233
a9e59c71d95e18cf3d1bc1b69ec7db4952834ebb1fb8a6de3449ada24c342384288ea4fc9c0d7277b7852798c1ec75e7aff14b93db8dacefd1e1d4fab3936a69
74ba75129f1e93488acc1a6446c3516247406da6d09f094a538035ca6db797d9d45149610b17d5a6edc0f52aaaedc5228d4eb7650ab2986da6171dd7a3a55c57
20ba951286c2890011df0af206a4aecd99e339349d7bb1cf426ee45976befdd2e9d6ad5a7d4a990f3f1680e262b6d3b252da7a65c65c792bc278bdea4e01c11a
df4ba8744b7223d450ae58655f7245b22ad7fd89b5d5db8eee72f9b1df42add42e9f1126470e0f36f3cfa921b793d38a3b8233839f56ae572b235ca692db2ef9
6549a839c60dbcaeba1e2a164db9b69b8953bdea522e2accedc95aa892a04588c3d196b909cb6ca7a7c1d6b8b6c13c89c6012a3a83ce9595a82c250e499d51ae
6e5cbddc12342f669b4699b7f56db49f55ab556d1a92d6e4485254ca15054b587438cada6d24ba95a41e4bcfd318273896b66ec5358525f9378e962a3b5f2899
a16cac48374d2ef4b82b522bf70dbf48145b75e7986586a2300293d62d363f11f50590564e3e891ad25a96e2e296137966d1d3a52527cb4b81621fb2f5121da9
7659e8b9eacaa6de735a9f57714dc5eb079a77ac7a243584052b19183e3b6a67af96e8cb0b3122f835b5c73d9ef9beced0273b613ce5cf534bbb74db4dd00a59
8bdfa2b4282a47e1fafb32849c63c7d4eb55ad6b770be7efb367a44f6f3e9e8cb59f679a3cd7aee66915b9b45a05fae34f5d54a8cd32b0ebada8a96b8aeb80aa
397b91e7f9877ed8d6b1d6496dcf2e3d1b3d32e71d4bb12f706e1da7a8b54ff6679d32b567c77550a98cc56e13650b40536b8804b73ac8014a4a72af249ef8d4
f446e4dea162457b9d6ff92f28c9b8db5163d9db674aa76e5de371cddb4b65d651168919b8cdadf73252d25c547612f3bc02947f30c2727e59d29d4d93b5bae2
b7b337510857f3b7b57e8495b165597bb95ab4b76ecd9d58a3d22d28e9a7daf10c461884588e56cb890db816ea87e64e491f6d693b6ca54aa976fb378570b5ab
23edd0e5ba1b3d45bf6bd6f5eb36b757a254ad2eabb1e4529680b2d2b0b5e39a1de2af47948ce3b6a1a3512ae2e2926a44b750a6d4b38c152ed9ed46ddee8591
794db0aecbae1dad79d5ca6ad1e4a5843dce2afa8e239b8db8b5870ba32a2a248f49ef9d5cbb5365538ee8c7315c15aad3c27196d6f0cb82cfda1fe0f16dc18b
71cf76dcb5d2e7c3e86188ac4771d75a5b5d790a6db0e3ae0eaa9592ac7239c6a9dba8df9e39659ae8d98e784599aac5823eb9578940a3cdad4e388b05853ce7
d4f11d923eea3d8680d29acd5e6d7eab32b3505729935e53ce7d067c207d923006b2684fd1a8b70cdb626ca7a5b341b11826555ab1397eef117d3ec391fccff1
f0940ed93f53aca8b93c2ecc3692cbe8a16f5dd682dca553ec22f3905bca7e3139a4b6b7bfa998deae923e9cc957d86bbba7f0a5dd9dfd3ff671f51e27ed5ffe
4414df179372d1399af541898d1e4d3cc3ea65493fd3d3e38d74969295fd28e6bd5daffa98f307da37751301ea25c5528f775bb293c26526e28edcd69d47d0b8
3a6f03f4217907bf9d432f0fab395f2bfb13475f6e30f95f72b5ab3f4c9539c914884ba74270f24c153c648649f2843aa0952903e5cbbfd49f3ab704d2c37965
4b1a6f2960b7bd9ffda0aadb3b5434ea825da8d873dde750a724e5c8ee1ec6545cf6e58fce8f0bfdfbea96bb42af595c4917745ad74bc3f49f466d7ba6dfbce8
b1ae1b62a0c54e8f2c65994c1c8c8f2950f295a7f5254323e7af31384a0f12ecf4909a92cae88ebda7447a19b43a665556e261f8b162215c30df0c3afb8bfd0d
b60f738249ec013ad4d8afad8a9d5be16ec354849dcda0a916fc387251c98434549fc54369292a4bad37cd6ee7384fc879182bdf6b8b4ab347816aef3d15cea5
cf674d65a9f2db474f9b0a742d85948270943fe8c67c3875d5f0cb13dd53ea473bc420d62c5dc47955dd5adcaa14bdc8dba4447dea2504ff000ca27ad288bf1b
9eca57314e2d4529061b0435ea2072538090355fcb8d52d93f77cfe9ff00d2756798b7c7d97e4afad5ddabc18de1dbcb79170c9add12eca41170b6ff0049f83f
13690f759ca6496d9639b48759e394726cf7009f3ab13d347c994b1869f1fa7dcaf1d44bcd8c739cae7f5fb10ee5fdbb13e46f9c362f79d1616df175ea3f18d0
d520865d7f836a78b3f938b58576e47b771df32f9152557cbebecd3ceb1f99cfa4c9716ec6e9d2f6f76b3789eaf4afe18aabacc2bde9f1598c01e9bea4f5da51
694a6cbedb4be401c72c6319d621a7a9cecab1f32f4999df6284279e1f65a17b5c1b8df04bc6f3dbbaec57698897121d33e2afc58f4e8d15a4a55529acbeea02
49e4ae9a3a8a207151009c0d53aa35e6319aff007d8b564a78728b2076b3736e09fbf75ab05baccfad58efd09babd29caab613250e716095b2e74a3ad4cb9d65
14f34771823b79975144550a78c4b38e08a9bdbb9c7398e05ef696b0ddba6977e5cf4c4115eb36a74daa30f37fcdf7434e68490923fc984bbfe8d4ba0b941c62
fa926bf269acab72935dc7071725eebde4d8aadde6ea7fc3dbf683d1e6020841b8a500dca29f91e8309f49ff00cff6d62157917a87d65f8ff7f612b3cea777d1
7e4f4edcd62f6a17b265b752b15ea7449ad4c7be273ea721a88d46a6fc41ff0078750ebf9682f1803903e7201381ac6a6307ab92967fc7d7034f292d32da7bf6
ff00722e6aa6ed5f7b78cd7eab3ad16adff8bd027d459435528eb2d30ae6da96cb44b6beb9523a88f1c4f8f3a5da78aa633c739c3fa1b557bf3650cf18e082db
ddcedd9ad7b3fa2ec8d54a58a83574aa3572b13d50e9688b4601b5bca64f4d2c07095f63c14aefd82958d497d14c6fdbcfa78fd4d68bac9539fbfe071d92dc7b
92b1bc97dd812ea93eaf69d3623551a1bd576433506d2e7472957e1b2b285f5b29ea2738c7d750ea688c6984fddf64ba7b9bb651f646c6eb9e5e29af688adaa2
5bd4fa0b4ac2aa724b8f01ff0066280ac7f75a93feda186206da6dcc2a9c37af5bcdc4c3b369e85bff008c7a687d2c8256b5abb619463b9fd5fb6b6596f0bb35
e12cbe8d6adfddf49dbb15914ba3f281b75495f1a2d2d23a41ee1e9129f40edc8ffd34fe84fdf3af4fa1d12a6397eb7f83ce6b758ed9617a4a6b5d039e1a00d0
068072db2db3b9b75ae862d9b69939385d42a0b04c7851b3ea79d3ff00e53e547b0d57d4ea234c32cb1a7d34ae9611f522c3b2a89b796ad3ad1b79ae95369cd7
00a3fcc75c57771e74fcd6e28951d792b6d95b272976cf55556ab8ed4782eeb5153ab14cbb69f57146ac5292a8c87de6c3f19d6a4a827a4e20a91e547b60f9fe
da8c90f15436e27caa9b37445afbb12f36874d5514476fdd971ffec2a367ba3ee5655f7f18026aa967b570d9d53b4ae494aa9a2b115e8d3a4ad01192fa71c9b6
c7640476281f2c79cf7d6f5cdc24a4bd8d270df169fb8a8f6cad24ec9ffc1785507e0c034d4c272aac247556ef30ebaf291900f59cc95a73dc1233a9be2a5e77
9bdf245f0ebcbd9d09f4cf668914dafd85722af8a84aa9d8d184163ab0e2f4dc868e49432d21380d04a16a4f2575147ce723534b5f98ce3b78911474787179f4
9998f672931dddca785d795ee621c4d4bfe5e3117a8ead64b3fe23bfa5d527d5f63a7c77a3e5f40f84f573ea20ab74db2ad5dbd73d96eb7549154b8a4dbefc8b
79ef73f77eb38b944c3420f3712b7d120e709fd23271df5b4653959f10b859e4c38c143c97cf03a5e1b054cbab67a89b491eaaf51a251843522630d87838e444
90beab4a52398714b2bf3f9b0750d5ac70b9d98ce492cd32956a1f4305afb1ee5237451ba68bd66d5ea429bf08acb4fc78a4c87194a5b57ada084b207493e84a
3231f9bb9d667abdd5797b70b3910d36db37e7d877a4599548b5db9aa359aa46a9d2ae7e98914bf72e88692d302304073aee734a9b1eae49f3e31e3503b38492
c344aab7979e98b07636041d9f7b672dca97c369129a7999951763893256992e9756a03a8d279f7e3939eda97e29bbbcc7cb23f87c57b10ad3bd98d73f69697b
4ceddcfa20d16a62a54fa8b50d28593cdd70b721aeb290e80a7b293e9c103cea55afc5aecdbda22f83fe5a867a25e97b0750a46e1d4f719abd66ccac5628a695
51f7e871dceab85a437d5fc2e804a07490436848f18e58d692d666b50dbc279375a5c4dcf3cb58159bf6494b5b730f6f1bbce5218a75c22e185393090141ee98
6d4871aeb14380710a41edc4fd46a6fe22fccdfb7db047f05f26dddef91decdd8e7ed1dd0aaee58bb2754a456e0a22d5624b8d1c2df75296c170bad8404272d0
21086c63c671a82cd56fa9578c6192d7a6db639e7b2dfd542d14e6e1d9d22fbdcca2d29ce49a2c1a67bd549d1db0dadf50e9a4ff0099ce18fdb27e5a181537b2
817d6ecbed6ceedbb48a4d954ee9ff0015dc0f65b87c9b014cd39809f53c5b185b894f6cf10a23beba1a39d747f327ccbd97fd94b5509dbf24785eecc36a7b14
6d551d86d572bd52b9278fe6a9d78c28f9fe96a394a80ffd4e1d6f678b5d2eb834afc32a8f7c8dd23d9536164b259fe116d9ff00c8ccb9a85ffbf5b502f10d47
f712bd0d2ffa443aff00b0d6dace0556fd62b34577e495adb9ccff00ed71295fff0066acc3c5ed5da4c827e1753eb82b79fec1d7721e229977d29f633d8c98cf
b0bc7ec853c3ff009d5a5e331f78955f843fee27ad7f60f691250f5e97697e2a482b87498fd152c7cc75df2bc7f66f51d9e32f1f2c492bf084bd4cda7b26c1b4
b6ee8c8a0da14c669b4f4fa9ce1953aeb98c751e75595b8b3f551d722db6563cc9e59d5aaa8d6b11e065d4648415c7467ebed0a62cf4e9ab6dc53ce0e257d5c7
16804a87e924ac1f9280d01e67e15cb2e994e4b8b4b3536e3b889aa65f5251d72df04380848e402fd582340490833c549121524aa19653d66f9287f886b2014a
7c04ac2c950faa46808e6e9971a6348419a3de16c0405951216f070a8ac76fc3e4dfa7b78feda033bf12bc69c5988e21897d75bad28ad4ac36857369a5139279
e0255f6ce80e5e855876ac894d3a598b98e549ea929e28ea7591d3c713cf927bfdb3a03ca8a1d4d6b75f96e21c9698ef36c49182f075d70e1c694a49e961b3c4
81d8ff006d326304b47454e3d1c36a0dbd546d9213ea506d4e77e3952b911f2cf9d0c91146a1d4a8f2aa0da161d8139943c57c836e267f1e0ea8009c7e200951
57f9b3db40644d36bc21426fde332a3c82b7545c57171acf60e7cf3c7fca719f963b680cc29f5cf7d7dd12c25b5191c144950e2e253d04f4fc0e91ce4fcffbe8
0eedc1a98890d1cd4990890cae592fa97c928187307e8af3c740755c4aea9554fc44f4e5c7508602ca4b0f00509c1c7850c289f91d01d114eac861295bc4a3de
cb863f595cfa1d1e011d6c72fe6fe27eddb4064620d65b994f75d93d56d98c96a6e54425c742559712918efcb1e7208fa11dc09cd01d78242cac247350c157cc81e3bfdb3a039094a4612001dcf6fa9ee74073a00d006803401a00d006803401a00d006803401a00d006803401a00d006803401a00d00680ffd9} \\par \\qr " . $_POST['nmcont'] . "\\par }";
		return $header_buffer;
	}
	function getFooter() {
		/*$footer_buffer = "\\ltrpar \\sectd \\ltrsect\\psz6\\sbknone\\linex0\\headery539\\footery0\\colsx708\\endnhere\\pgbrdropt32\\sectlinegrid360\\sectdefaultcl\\sectrsid609040\\sftnbj
{\\footerr \\qc ______________________________________________________________________\\par {\\fs10 {\\qc { Recife/PE: \\line Rua Real da Torre, 1.595, Torre, Recife-PE.Pabx: (81) 2121-6500 Fax: (81) 2121-6565 www.abraz.adv.br - abraz@abraz.adv.br \\cell }}
{\\qc {Savador/BA: \\line Rua Alceu Amoroso Lima, 314, 201, Edifício Antares Empresarial, Caminho das Arvores, Salvador-BA. Fone: ( 71 ) 3186-6500 \\cell }}
{\\qc {Maceió/AL: \\line Avenida Cdor Gustavo Paiva, 2789, sala 104/105, Mangabeiras, Maceió - AL. CEP-57038-000. Fone: (82) 372-6125 Fax: (82) 372-6010\\cell}}
{\\qc { " . $_POST['nomerodape'] . ": \\line " . $_POST['rodape'] . "\\cell}} \\trowd \\irow0\\irowband0\\lastrow \\ltrrow\\ts11\\trqc\\trgaph70\\trrh567\\trleft-70\\clvertalc\\cellx2200\\clvertalc\\cellx4400\\clvertalc\\cellx6600\\clvertalc\\cellx8800\\row}
\\qc \\par {\\fs18\\pard\\qc -{{\\field{\\*\\fldinst{\\f23  PAGE }}{\\fldrslt{\\f23 3}}}}-} \\pard}";*/
		$footer_buffer = "{\\footerr {\\rtlch\\fcs1 {\\shp{\\*\\shpinst\\shpleft0\\shptop0\\shpright612\\shpbottom493\\shpfhdr0\\shpbxpage\\shpbxignore\\shpbypage\\shpbyignore\\shpwr3\\shpwrk0\\shpfblwtxt0\\shpz0\\shplid2049
{\\sp{\\sn fFilled}{\\sv 1}}{\\sp{\\sn lineWidth}{\\sv 6350}}{\\sp{\\sn fLine}{\\sv 0}}{\\sp{\\sn wzName}{\\sv Caixa de Texto 49}}{\\sp{\\sn posrelh}{\\sv 1}}
{\\sp{\\sn posrelv}{\\sv 1}}{\\sp{\\sn dhgt}}{\\sp{\\sn fLayoutInCell}{\\sv 1}}{\\sp{\\sn fAllowOverlap}{\\sv 1}}{\\sp{\\sn fBehindDocument}{\\sv 0}}{\\sp{\\sn fHidden}{\\sv 0}}{\\sp{\\sn pctHoriz}{\\sv 50}}
{\\sp{\\sn pctVert}{\\sv 50}}{\\sp{\\sn pctHorizPos}{\\sv 910}}{\\sp{\\sn pctVertPos}{\\sv 930}}{\\sp{\\sn fLayoutInCell}{\\sv 1}}{\\shptxt \\ltrpar \\pard\\plain \\ltrpar\\qc \\li0\\ri0\\sl276\\slmult1\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 
\\rtlch\\fcs1 \\af31507\\afs22\\alang1025 \\ltrch\\fcs0 \\f31506\\fs22\\lang1046\\langfe1033\\cgrid\\langnp1046\\langfenp1033 {\\field{\\*\\fldinst {\\rtlch\\fcs1 \\af31507\\afs26 \\ltrch\\fcs0 \\fs26\\cf17\\insrsid7816641\\charrsid7816641 PAGE  \\\\* Arabic  \\\\* MERGEFORMAT}
}}\\par }}}{\\shprslt{\\*\\do\\dobxpage\\dobypage\\dodhgt8192\\dptxbx\\dptxlrtb{\\dptxbxtext\\ltrpar \\pard\\plain \\ltrpar\\qc \\li0\\ri0\\sl276\\slmult1\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af31507\\afs22\\alang1025 \\ltrch\\fcs0 
\\f31506\\fs22\\lang1046\\langfe1033\\cgrid\\langnp1046\\langfenp1033 {\\field{\\*\\fldinst {\\rtlch\\fcs1 \\af31507\\afs26 \\ltrch\\fcs0 \\fs26\\cf17\\insrsid7816641\\charrsid7816641 PAGE  \\\\* Arabic  \\\\* MERGEFORMAT}}}}\\dpx0\\dpy0\\dpxsize612\\dpysize493\\dpfillfgcr255\\dpfillfgcg255\\dpfillfgcb255\\dpfillbgcr129\\dpfillbgcg12\\dpfillbgcb0\\dpfillpat1\\dplinehollow}}}}";

		return $footer_buffer;
	}
	
	// Font table
	function getFontTable() {
		global $fonts_array;
		
		$font_buffer = "{\\fonttbl\n";
		foreach($fonts_array AS $fnum => $farray) {
			$font_buffer .= "{\\f{$fnum}\\f{$farray['family']}\\fcharset{$farray['charset']} {$farray['name']}}\n";
		}
		$font_buffer .= "}\n\n";
		
		return $font_buffer;
	}
	
	// Colour table
	function getColourTable() {
		$colour_buffer = "";
		if(sizeof($this->colour_table) > 0) {
			$colour_buffer = "{\\colortbl;\n";
			foreach($this->colour_table AS $cnum => $carray) {
				$colour_buffer .= "\\red{$carray['red']}\\green{$carray['green']}\\blue{$carray['blue']};\n";	
			}
			$colour_buffer .= "}\n\n";
		}
		
		return $colour_buffer;
	}
	
	// Information
	function getInformation() {
		$info_buffer = "";
		if(sizeof($this->info_table) > 0) {
			$info_buffer = "{\\info\n";
			foreach($this->info_table AS $name => $value) {
				$info_buffer .= "{\\{$name} {$value}}";
			}
			$info_buffer .= "}\n\n";
		}
		
		return $info_buffer;
	}
	
	// Default font settings
	function getDefaultFont() {
		$font_buffer = "\\f{$this->font_face}\\fs{$this->font_size}\n";
		
		return $font_buffer;
	}
	
	// Page display settings
	function getPageSettings() {
		if($this->page_orientation == 1)
			$page_buffer = "\\paperw{$this->page_width}\\paperh{$this->page_height}\n";
		else
			$page_buffer = "\\paperw{$this->page_height}\\paperh{$this->page_width}\\landscape\n";
			
		$page_buffer .= "\\pgncont\\pgndec\\pgnstarts1\\pgnrestart\n";
		
		return $page_buffer;
	}
	
	// Convert special characters to ASCII
	function specialCharacters($text) {
		$text_buffer = "";
		for($i = 0; $i < strlen($text); $i++)
			$text_buffer .= $this->escapeCharacter($text[$i]);
		
		return $text_buffer;
	}
	
	// Convert special characters to ASCII
	function escapeCharacter($character) {
		$escaped = "";
		if(ord($character) >= 0x00 && ord($character) < 0x20)
			$escaped = "\\'".dechex(ord($character));
		
		if ((ord($character) >= 0x20 && ord($character) < 0x80) || ord($character) == 0x09 || ord($character) == 0x0A)
			$escaped = $character;
		
		if (ord($character) >= 0x80 and ord($character) < 0xFF)
			$escaped = "\\'".dechex(ord($character));

		switch(ord($character)) {
			case 0x5C:
			case 0x7B:
			case 0x7D:
				$escaped = "\\".$character;
				break;
		}
		
		return $escaped;
	}
	
	// Parse the text input to RTF
	function parseDocument() {
		$doc_buffer = $this->specialCharacters($this->document);
		
		if(preg_match("/<UL>(.*?)<\/UL>/mi", $doc_buffer)) {
			$doc_buffer = str_replace("<UL>", "", $doc_buffer);
			$doc_buffer = str_replace("</UL>", "", $doc_buffer);
			$doc_buffer = preg_replace("/<LI>(.*?)<\/LI>/mi", "\\f3\\'B7\\tab\\f{$this->font_face} \\1\\par", $doc_buffer);
		}
		if(preg_match("/<ul>(.*?)<\/ul>/mi", $doc_buffer)) {
			$doc_buffer = str_replace("<ul>", "", $doc_buffer);
			$doc_buffer = str_replace("</ul>", "", $doc_buffer);
			$doc_buffer = preg_replace("/<li>(.*?)<\/li>/mi", "\\f3\\'B7\\tab\\f{$this->font_face} \\1\\par", $doc_buffer);
		}
		
		$doc_buffer = str_replace("&aacute;","\'e1", $doc_buffer);
		$doc_buffer = str_replace("&agrave;","\'e0", $doc_buffer);
		$doc_buffer = str_replace("&atilde;","\'e3", $doc_buffer);
		$doc_buffer = str_replace("&acirc;","\'e2",  $doc_buffer);
		$doc_buffer = str_replace("&eacute;","\'e9", $doc_buffer);
		$doc_buffer = str_replace("&ecirc;","\'ea", $doc_buffer);
		$doc_buffer = str_replace("&iacute;","\'ed", $doc_buffer);
		$doc_buffer = str_replace("&oacute;","\'f3", $doc_buffer);
		$doc_buffer = str_replace("&otilde;","\'f5", $doc_buffer);
		$doc_buffer = str_replace("&ocirc; ","\'f4", $doc_buffer);
		$doc_buffer = str_replace("&uacute;","\'fa", $doc_buffer);
		
		$doc_buffer = str_replace("&Aacute;","\'c1", $doc_buffer);
		$doc_buffer = str_replace("&Agrave;","\'c0", $doc_buffer);
		$doc_buffer = str_replace("&Acirc;","\'c3", $doc_buffer);
		$doc_buffer = str_replace("&Aring;","\'c2", $doc_buffer);
		$doc_buffer = str_replace("&Eacute;","\'c9", $doc_buffer);
		$doc_buffer = str_replace("&Ecirc;","\'ca", $doc_buffer);
		$doc_buffer = str_replace("&Iacute;","\'cd", $doc_buffer);
		$doc_buffer = str_replace("&Oacute;","\'d3", $doc_buffer);
		$doc_buffer = str_replace("&Otilde;","\'d5", $doc_buffer);
		$doc_buffer = str_replace("&Ocirc;","\'d4", $doc_buffer);
		$doc_buffer = str_replace("&Uacute;","\'da", $doc_buffer);
		
		$doc_buffer = str_replace("&ccedil;","\'e7", $doc_buffer); 
		$doc_buffer = str_replace("&Ccedil;","\'c7\'c3", $doc_buffer);
		
		$doc_buffer = str_replace("&deg;","\'ba", $doc_buffer);
		
		$doc_buffer = preg_replace("/<P>(.*?)<\/P>/mi", "\\1\\par ", $doc_buffer);
		$doc_buffer = preg_replace("/<DIV>(.*?)<\/DIV>/mi", "\\1\\par ", $doc_buffer);
		$doc_buffer = preg_replace("/<STRONG>(.*?)<\/STRONG>/mi", "\\b \\1\\b0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<EM>(.*?)<\/EM>/mi", "\\i \\1\\i0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<I>(.*?)<\/I>/mi", "\\i \\1\\i0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<U>(.*?)<\/U>/mi", "\\ul \\1\\ul0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<STRIKE>(.*?)<\/STRIKE>/mi", "\\strike \\1\\strike0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<SUB>(.*?)<\/SUB>/mi", "{\\sub \\1}", $doc_buffer);
		$doc_buffer = preg_replace("/<SUP>(.*?)<\/SUP>/mi", "{\\super \\1}", $doc_buffer);
		
		$doc_buffer = preg_replace("/<span style=\"text-decoration: underline;\">(.*?)<\/span>/mi", "\\ul \\1\\ul0 ", $doc_buffer);
		
		$doc_buffer = preg_replace("/<p style=\"text-align: justify;\">(.*?)<\/p>/mi", "\qj \\1\\qj0", $doc_buffer);
		$doc_buffer = preg_replace("/<p style=\"text-align: right;\">(.*?)<\/p>/mi", "\qr \\1\\qr0", $doc_buffer);
		$doc_buffer = preg_replace("/<p style=\"text-align: left;\">(.*?)<\/p>/mi", "\ql \\1\\ql0", $doc_buffer);
		$doc_buffer = preg_replace("/<p style=\"text-align: center;\">(.*?)<\/p>/mi", "\qc \\1\\qc0", $doc_buffer);
		
		$doc_buffer = preg_replace("/<P align=justify>(.*?)<\/P>/mi", "\qj \\1\\qj0 \\par", $doc_buffer);
		
		
		$doc_buffer = preg_replace("/<p style=border: 0px solid rgb(0, 0, 0); margin-left: 0px; class=cls_para align=justify>(.*?)<\/P>/mi", "\qj \\1\\qj0 \\par", $doc_buffer);
		
		
		$doc_buffer = preg_replace("/<P align=right>(.*?)<\/P>/mi", "\qr \\1\\qr0 \\par", $doc_buffer);
		$doc_buffer = preg_replace("/<P align=left>(.*?)<\/P>/mi", "\ql \\1\\ql0 \\par", $doc_buffer);
		$doc_buffer = preg_replace("/<P align=center>(.*?)<\/P>/mi", "\qc \\1\\qc0 \\par", $doc_buffer);
		
		$doc_buffer = preg_replace("/<DIV style=\"text-align: justify;\">(.*?)<\/DIV>/mi", "\qj \\1\\qj0", $doc_buffer);
		$doc_buffer = preg_replace("/<DIV style=\"text-align: right;\">(.*?)<\/DIV>/mi", "\qr \\1\\qr0", $doc_buffer);
		$doc_buffer = preg_replace("/<DIV style=\"text-align: left;\">(.*?)<\/DIV>/mi", "\ql \\1\\ql0", $doc_buffer);
		$doc_buffer = preg_replace("/<DIV style=\"text-align: center;\">(.*?)<\/DIV>/mi", "\qc \\1\\qc0", $doc_buffer);
		$doc_buffer = preg_replace("/<DIV align=justify>(.*?)<\/DIV>/mi", "\qj \\1\\qj0 \\line", $doc_buffer);
		$doc_buffer = preg_replace("/<DIV align=right>(.*?)<\/DIV>/mi", "\qr \\1\\qr0 \\line", $doc_buffer);
		$doc_buffer = preg_replace("/<DIV align=left>(.*?)<\/DIV>/mi", "\ql \\1\\ql0 \\line", $doc_buffer);
		$doc_buffer = preg_replace("/<DIV align=center>(.*?)<\/DIV>/mi", "\qc \\1\\qc0 \\line", $doc_buffer);
		
		
		$doc_buffer = preg_replace("/<FONT face=\"times new roman\">(.*?)<\/FONT>/mi", "\\f0 \\1", $doc_buffer);
		
		//--Tabelas-------------------------------------------------------
		$doc_buffer = str_replace("<TABLE border=1 cellSpacing=0 borderColor=#000000 cellPadding=2 width=500>","{", $doc_buffer);
		$doc_buffer = str_replace("</TABLE>","}", $doc_buffer);
		$doc_buffer = str_replace("<TBODY>","", $doc_buffer);
		$doc_buffer = str_replace("</TBODY>","", $doc_buffer);
		
		$doc_buffer = str_replace("<TR height=30>","{\\qc\\trowd\\irow0\\irowband0\\lastrow\\ltrrow\\ts11\\trqc\\trgaph70\\trrh450\\trleft-70 ", $doc_buffer);
		$doc_buffer = str_replace("</TR>","\\row}", $doc_buffer);
		
		$doc_buffer = preg_replace("/<TD align=left>(.*?)<\/TD>/mi"," \\1 \\ql \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clbrdrr\\brdrs\\brdrw10\\clftsWidth3\\clwWidth1500\\cellx\\q0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<TD align=middle>(.*?)<\/TD>/mi"," \\1 \\ql \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clbrdrr\\brdrs\\brdrw10\\clftsWidth3\\clwWidth1500\\cellx\\q0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<TD>(.*?)<\/TD>/mi"," \\1 \\ql \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clbrdrr\\brdrs\\brdrw10\\clftsWidth3\\clwWidth1500\\cellx\\q0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<TD colSpan=5 align=left>(.*?)<\/TD>/mi"," \\1 \\ql \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clftsWidth3\\clwWidth1500\\cellx\\ql0 \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clftsWidth3\\clwWidth1500\\cellx\\ql0 \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clftsWidth3\\clwWidth1500\\cellx\\ql0 \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clftsWidth3\\clwWidth1500\\cellx\\ql0 \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clftsWidth3\\clwWidth1500\\cellx\\ql0 \\q0 ", $doc_buffer);
		
		$doc_buffer = preg_replace("/<DIV class=titulos>(.*?)<\/DIV>/mi","{{\\qc\\trowd\\irow0\\irowband0\\lastrow\\ltrrow\\ts11\\trqc\\trgaph70\\trrh300\\trleft-70 \\b \\1\\b0 \\qc \\cell \\clvertalc\\clbrdrt\\brdrs\\brdrw10\\clbrdrl\\brdrs\\brdrw10\\clbrdrb\\brdrs\\brdrw10\\clbrdrr\\brdrs\\brdrw10\\clftsWidth3\\clwWidth9000\\cellx\\q0 \\row}}", $doc_buffer);
		
		$doc_buffer = preg_replace("/<B>(.*?)<\/B>/mi", "\\b \\1\\b0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<STRONG>(.*?)<\/B>/mi", "\\b \\1\\b0 ", $doc_buffer);
		
		//=---------------------------------------------------------------
		
		$doc_buffer = preg_replace("/<p>(.*?)<\/p>/mi", "\\1\\par ", $doc_buffer);
		$doc_buffer = preg_replace("/<strong>(.*?)<\/strong>/mi", "\\b \\1\\b0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<em>(.*?)<\/em>/mi", "\\i \\1\\i0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<i>(.*?)<\/i>/mi", "\\i \\1\\i0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<u>(.*?)<\/u>/mi", "\\ul \\1\\ul0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<strike>(.*?)<\/strike>/mi", "\\strike \\1\\strike0 ", $doc_buffer);
		$doc_buffer = preg_replace("/<sub>(.*?)<\/sub>/mi", "{\\sub \\1}", $doc_buffer);
		$doc_buffer = preg_replace("/<sup>(.*?)<\/sup>/mi", "{\\super \\1}", $doc_buffer);
		
	  //$doc_buffer = preg_replace("/<H1>(.*?)<\/H1>/mi", "\\pard\\qc\\fs40 \\1\\par\\pard\\fs{$this->font_size} ", $doc_buffer);
	  //$doc_buffer = preg_replace("/<H2>(.*?)<\/H2>/mi", "\\pard\\qc\\fs32 \\1\\par\\pard\\fs{$this->font_size} ", $doc_buffer);
		
		$doc_buffer = preg_replace("/<H1>(.*?)<\/H1>/mi", "\\fs48\\b \\1\\b0\\fs{$this->font_size}\\par ", $doc_buffer);
		$doc_buffer = preg_replace("/<H2>(.*?)<\/H2>/mi", "\\fs36\\b \\1\\b0\\fs{$this->font_size}\\par ", $doc_buffer);
		$doc_buffer = preg_replace("/<H3>(.*?)<\/H3>/mi", "\\fs27\\b \\1\\b0\\fs{$this->font_size}\\par ", $doc_buffer);

		$doc_buffer = preg_replace("/<h1>(.*?)<\/h1>/mi", "\\fs48\\b \\1\\b0\\fs{$this->font_size}\\par ", $doc_buffer);
		$doc_buffer = preg_replace("/<h2>(.*?)<\/h2>/mi", "\\fs36\\b \\1\\b0\\fs{$this->font_size}\\par ", $doc_buffer);
		$doc_buffer = preg_replace("/<h3>(.*?)<\/h3>/mi", "\\fs27\\b \\1\\b0\\fs{$this->font_size}\\par ", $doc_buffer);
		
		//Fontes-------------
		$doc_buffer = preg_replace("/<FONT size=1>(.*?)<\/FONT>/mi", "\\fs16 \\1\\fs{$this->font_size} ", $doc_buffer);
		$doc_buffer = preg_replace("/<FONT size=2>(.*?)<\/FONT>/mi", "\\fs20 \\1\\fs{$this->font_size} ", $doc_buffer);
		$doc_buffer = preg_replace("/<FONT size=3>(.*?)<\/FONT>/mi", "\\fs24 \\1\\fs{$this->font_size} ", $doc_buffer);
		$doc_buffer = preg_replace("/<FONT size=4>(.*?)<\/FONT>/mi", "\\fs28 \\1\\fs{$this->font_size} ", $doc_buffer);
		$doc_buffer = preg_replace("/<FONT size=5>(.*?)<\/FONT>/mi", "\\fs36 \\1\\fs{$this->font_size} ", $doc_buffer);
		$doc_buffer = preg_replace("/<FONT size=6>(.*?)<\/FONT>/mi", "\\fs48 \\1\\fs{$this->font_size} ", $doc_buffer);
		//-------------------
		
		
		$doc_buffer = preg_replace("/<HR(.*?)>/i", "\\brdrb\\brdrs\\brdrw30\\brsp20 \\pard\\par ", $doc_buffer);
		$doc_buffer = preg_replace("/<hr(.*?)>/i", "\\brdrb\\brdrs\\brdrw30\\brsp20 \\pard\\par ", $doc_buffer);
		
		//$doc_buffer = preg_replace("/<BLOCKQUOTE style=\"MARGIN-RIGHT: 0px\" dir=ltr>(.*?)<\/BLOCKQUOTE>/mi", "\\lin2708\\1 \\lin0 ", $doc_buffer);
		
		$doc_buffer = preg_replace("/<P class=recuo align=justify>(.*?)<\/P>/mi", "\\lin2000 \\1 \\par \lin0", $doc_buffer);
		
		
		$doc_buffer = str_replace("<BR>", "\\line ", $doc_buffer);
		$doc_buffer = str_replace("<BR />", "\\line ", $doc_buffer);
		$doc_buffer = str_replace("<br>", "\\line ", $doc_buffer);
		$doc_buffer = str_replace("<br />", "\\line ", $doc_buffer);
		$doc_buffer = str_replace("&nbsp;", " ", $doc_buffer);
	
		
		$doc_buffer = str_replace("<TAB>", "\\tab ", $doc_buffer);
		$doc_buffer = str_replace("<tab>", "\\tab ", $doc_buffer);
		$doc_buffer = str_replace("<SPAN class=tabs></SPAN>", "\\tab \\tab \\tab ", $doc_buffer);
		$doc_buffer = str_replace("<span class=tabs></span>", "\\tab \\tab \\tab ", $doc_buffer);
		$doc_buffer = str_replace("<SPAN class=tabs> </SPAN>", "\\tab \\tab \\tab ", $doc_buffer);
		$doc_buffer = str_replace("<span class=tabs> </span>", "\\tab \\tab \\tab ", $doc_buffer);		
		
		$doc_buffer = preg_replace("/<BLOCKQUOTE (.*?)>/i", " \\lin2000 ", $doc_buffer);
		//$doc_buffer = str_replace("<BLOCKQUOTE dir=ltr>", "\\lin2000 ", $doc_buffer);
		//$doc_buffer = str_replace("<BLOCKQUOTE style=\"MARGIN-RIGHT: 0px\" dir=ltr>", "\\lin2000 ", $doc_buffer);
		$doc_buffer = str_replace("</BLOCKQUOTE>", " \\lin0", $doc_buffer);
		$doc_buffer = str_replace("</blockquote>", " \\lin0", $doc_buffer);
		
		
		$doc_buffer = $this->nl2par($doc_buffer);
		
		return $doc_buffer;
	}
}
?>